## 📋 项目开发规范

### 🎯 核心原则
- **代码质量优先**：编写清晰、可维护、可测试的代码
- **架构一致性**：严格遵循现有架构模式
- **安全性**：所有代码必须考虑安全因素
- **性能优化**：关注代码性能，避免不必要的资源消耗
- **团队协作**：代码风格统一，便于团队协作

## 🛠️ 技术栈

### 前端
- **框架**：React 19.2.0
- **构建工具**：Vite 7.2.4
- **UI组件库**：Ant Design 6.1.2
- **路由**：React Router 7.10.1
- **代码规范**：ESLint 9.39.1

### 后端
- **语言**：Go 1.25.5
- **Web框架**：go-zero 1.9.3
- **RPC框架**：gRPC 1.77.0
- **ORM**：GORM 1.31.1
- **数据库**：MySQL
- **认证**：JWT 5.3.0
- **配置管理**：Viper 1.21.0

## 📁 项目架构

### 前端架构
```
frontend/src/
├── components/    # 可复用组件
├── hooks/         # 自定义React Hooks
├── pages/         # 页面组件
├── styles/        # 全局样式
└── utils/         # 工具函数
```

### 后端架构
```
backend/
├── api/           # HTTP API服务
│   ├── internal/
│   │   ├── handler/   # API请求处理器
│   │   ├── logic/     # 业务逻辑
│   │   └── svc/       # 服务上下文
│   └── etc/           # 配置文件
├── rpc/           # gRPC服务
│   ├── internal/
│   │   ├── logic/     # 业务逻辑
│   │   ├── server/    # gRPC服务器
│   │   └── svc/       # 服务上下文
│   └── pb/            # Protocol Buffers生成的代码
├── proto/         # Protocol Buffers定义
├── model/         # 数据库模型
└── utils/         # 工具函数
```

## 🔧 代码规范

### 前端代码规范
1. **组件命名**：使用PascalCase，如 `MainLayout.jsx`
2. **函数命名**：使用camelCase，如 `handleLogin()`
3. **文件命名**：组件文件使用PascalCase，其他文件使用kebab-case或camelCase
4. **代码格式化**：使用ESLint进行代码检查，遵循项目配置的规则
5. **导入顺序**：
   - 外部依赖
   - 内部组件
   - 样式文件
6. **状态管理**：使用React Hooks管理状态，复杂状态考虑使用Context API
7. **组件设计**：遵循单一职责原则，组件应小而专注

### 后端代码规范
1. **包命名**：使用小写字母，如 `handler`、`logic`
2. **函数命名**：使用驼峰命名，如 `LoginLogic`、`GetUserHandler`
3. **文件命名**：使用蛇形命名，如 `login_logic.go`、`get_user_handler.go`
4. **代码格式化**：使用 `gofmt` 进行代码格式化
5. **注释规范**：为公共函数、结构体添加注释
6. **错误处理**：所有错误必须被处理，不能忽略
7. **分层架构**：严格遵循go-zero的分层架构，禁止跨层调用

## 🗄️ 数据库规范

### 数据库设计
1. **表命名**：使用小写字母，下划线分隔，如 `user_info`、`vip_order`
2. **字段命名**：使用小写字母，下划线分隔，如 `user_id`、`created_at`
3. **主键设计**：使用自增ID或UUID作为主键
4. **外键约束**：适当使用外键约束，确保数据完整性
5. **索引设计**：为频繁查询的字段添加索引
6. **时间字段**：所有表必须包含 `created_at` 和 `updated_at` 字段

### 数据库操作
1. **事务管理**：所有涉及多个表修改的操作必须使用事务
2. **错误处理**：数据库操作错误必须被捕获和处理
3. **查询优化**：避免全表扫描，合理使用索引
4. **ORM使用**：使用GORM进行数据库操作，遵循GORM最佳实践
5. **连接池**：使用连接池管理数据库连接，避免频繁创建和关闭连接

## 🌐 API规范

### API设计原则
1. **RESTful风格**：HTTP API遵循RESTful设计原则
2. **版本控制**：API必须包含版本号，如 `/api/v1/users`
3. **命名规范**：使用小写字母，下划线分隔，如 `/api/v1/user_info`
4. **参数验证**：所有API参数必须进行验证
5. **响应格式**：统一响应格式，包含 `code`、`msg` 和 `data` 字段

### API响应格式
```json
{
  "code": 0,
  "msg": "success",
  "data": {}
}
```

### gRPC规范
1. **服务命名**：使用PascalCase，如 `SuperService`
2. **方法命名**：使用驼峰命名，如 `Login`、`GetUser`
3. **消息命名**：使用PascalCase，如 `LoginRequest`、`LoginResponse`
4. **字段命名**：使用蛇形命名，如 `user_id`、`user_name`
5. **版本控制**：在proto文件中使用包名进行版本控制

## 🚨 错误处理

### 前端错误处理
1. **捕获异步错误**：使用 `try-catch` 捕获异步操作错误
2. **错误提示**：使用Ant Design的 `message` 或 `Modal` 组件显示错误信息
3. **全局错误处理**：实现全局错误边界，防止应用崩溃
4. **网络错误处理**：统一处理API请求错误，如404、500等

### 后端错误处理
1. **错误定义**：使用统一的错误码和错误信息
2. **错误返回**：所有API请求必须返回标准的错误格式
3. **日志记录**：所有错误必须被记录到日志中
4. **panic处理**：使用recover捕获panic，防止服务崩溃
5. **错误码规范**：
   - 0：成功
   - 1000-1999：参数错误
   - 2000-2999：业务逻辑错误
   - 3000-3999：系统错误
   - 4000-4999：认证授权错误

## 🔒 安全规范

### 认证与授权
1. **JWT认证**：使用JWT进行身份认证
2. **密码安全**：密码必须使用bcrypt等算法进行加密存储
3. **权限控制**：实现基于角色的访问控制（RBAC）
4. **API限流**：对API请求进行限流，防止恶意请求
5. **CSRF防护**：实现CSRF防护机制

### 数据安全
1. **数据加密**：敏感数据必须加密存储
2. **数据验证**：所有输入数据必须进行验证，防止SQL注入、XSS等攻击
3. **HTTPS**：所有API请求必须使用HTTPS
4. **CORS配置**：正确配置CORS，只允许信任的域名访问API

## 🧪 测试规范

### 前端测试
1. **组件测试**：使用React Testing Library进行组件测试
2. **单元测试**：测试工具函数和自定义Hooks
3. **E2E测试**：使用Cypress或Playwright进行端到端测试
4. **测试覆盖率**：关键组件和功能的测试覆盖率不低于80%

### 后端测试
1. **单元测试**：测试业务逻辑和工具函数
2. **集成测试**：测试API和数据库操作
3. **性能测试**：对关键API进行性能测试
4. **测试覆盖率**：核心业务逻辑的测试覆盖率不低于80%

## 🚀 开发流程

1. **需求分析**：明确需求，制定开发计划
2. **代码编写**：遵循项目规范编写代码
3. **代码审查**：提交代码前进行自我审查，确保代码质量
4. **测试**：运行测试用例，确保功能正常
5. **部署**：部署到测试环境进行验证
6. **上线**：通过验证后，部署到生产环境

## 📝 文档规范

1. **API文档**：使用Swagger或类似工具生成API文档
2. **技术文档**：编写关键模块的技术文档
3. **README文件**：每个模块必须包含README文件，说明模块功能和使用方法
4. **注释规范**：代码中添加必要的注释，解释复杂逻辑

## 🛡️ 注意事项

1. **每次生成代码前**：必须检查当前目录结构，遵循现有架构
2. **生成API时**：必须同时生成前端调用代码和后端处理逻辑
3. **数据库操作**：必须包含错误处理和事务管理
4. **组件生成**：必须包含PropTypes或TypeScript类型定义
5. **错误处理**：必须实现，不能有空的catch块
6. **安全考虑**：所有代码必须考虑安全因素，防止常见攻击
7. **性能优化**：关注代码性能，避免不必要的资源消耗
8. **代码复用**：尽量复用现有代码，避免重复开发
9. **版本控制**：使用Git进行版本控制，遵循Git工作流
10. **团队协作**：遵循团队约定的代码风格和开发流程

## 📊 代码质量检查

1. **前端**：运行 `npm run lint` 进行代码检查
2. **后端**：运行 `go vet` 和 `golint` 进行代码检查
3. **CI/CD**：集成CI/CD流程，自动进行代码检查和测试

## 🔄 版本控制规范

1. **分支管理**：
   - `main`：主分支，用于生产环境
   - `develop`：开发分支，用于集成测试
   - `feature/xxx`：特性分支，用于开发新功能
   - `fix/xxx`：修复分支，用于修复bug
2. **提交规范**：
   - 提交信息应清晰描述修改内容
   - 使用英文或中文，保持一致性
   - 格式：`类型: 描述`，如 `feat: 添加用户登录功能`
3. **合并请求**：
   - 提交合并请求前必须通过所有测试
   - 合并请求必须经过代码审查

## 📦 依赖管理

1. **前端依赖**：使用npm进行依赖管理，定期更新依赖版本
2. **后端依赖**：使用go mod进行依赖管理，定期更新依赖版本
3. **依赖安全**：定期检查依赖的安全漏洞，及时更新有漏洞的依赖

## 📈 性能优化

1. **前端性能优化**：
   - 组件懒加载
   - 代码分割
   - 图片优化
   - 减少不必要的渲染
2. **后端性能优化**：
   - 数据库查询优化
   - 缓存策略
   - 并发处理
   - 资源池管理

## 📱 跨端兼容性

1. **浏览器兼容性**：支持主流浏览器，包括Chrome、Firefox、Safari、Edge
2. **响应式设计**：适配不同屏幕尺寸，包括桌面端、平板和移动端

## 🔧 开发工具

1. **前端开发工具**：
   - VS Code
   - Chrome DevTools
   - ESLint
2. **后端开发工具**：
   - GoLand或VS Code
   - MySQL Workbench
   - gRPCurl

## 📌 最佳实践

1. **代码复用**：尽量复用现有代码，避免重复开发
2. **单一职责**：每个函数和组件应只负责一个功能
3. **可测试性**：编写可测试的代码，便于单元测试和集成测试
4. **可扩展性**：设计具有良好扩展性的代码，便于未来功能扩展
5. **可读性**：编写清晰、易读的代码，便于团队协作和维护

## 🔍 代码审查要点

1. **代码规范**：是否遵循项目代码规范
2. **架构一致性**：是否遵循项目架构设计
3. **错误处理**：是否正确处理所有可能的错误
4. **安全性**：是否存在安全隐患
5. **性能**：是否存在性能问题
6. **可测试性**：是否便于测试
7. **可读性**：代码是否清晰、易读

## 🚨 常见错误避免

1. **前端常见错误**：
   - 未处理异步错误
   - 组件过度渲染
   - 内存泄漏
   - 硬编码配置
2. **后端常见错误**：
   - 忽略错误处理
   - SQL注入
   - 资源泄漏
   - 硬编码配置
   - 不安全的认证授权

## 🌟 团队协作建议

1. **定期沟通**：定期召开团队会议，沟通项目进展和问题
2. **知识共享**：分享技术知识和最佳实践
3. **代码审查**：积极参与代码审查，提高代码质量
4. **持续学习**：关注新技术和最佳实践，持续提升技能

## 📋 项目规则更新日志

- 2025-12-26：初始版本，包含核心开发规范和注意事项

---

以上规范旨在确保项目代码质量、可维护性和安全性，所有团队成员必须严格遵守。
